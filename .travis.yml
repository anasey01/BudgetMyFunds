os:
- linux
language: php
php:
- '7.2'
services:
- postgresql
env:
  global:
  - CC_TEST_REPORTER_ID=6d1d2389d19dda26d84170e56c7f339b299782fb6fafc53e6e77540724e31b0e
before_script:
- cp .env.travis .env
- psql -c 'create database budget_my_funds_test;' -U postgres
- composer self-update
- composer install --no-interaction
- php artisan key:generate
- php artisan migrate
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64
  > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- "./cc-test-reporter before-build"
script:
- vendor/bin/phpunit
deploy:
  provider: heroku
  api_key:
    secure: X6hdVUvhOIZetlnnYoqEzBm6EfmjeQ1oqoyBqJzA0QlUWLT0J+vU1YImFMYihqiweY1EXAy7fjPinwZGzdWrz0R5y5VPfeo/XYwtnO9JxUUlxzkTXJY5JGs5QWaQ/3yMoYQ10wgqVb2At1DHcXeEJJyeaGBdRDYcJEeWopFc2oxuT0Xk62EvT6OjXxis2VSpevQg1nohsJ1f3CPfhQsff2dS9CVxAu8L7XeUAKggi3KW0lD2GFuCQFhPFJKENLGVsIVi1k4kA2aRMaKhCvXdQdkbDtnJMfa+n9sdx/bmJXpacXWrfUNQUtjETnKW0l2nWSJ5UBMkmC6wUfhXRlr72zYOTzF0PPJjuVGVXokz1tFYs23NosJLvt2GWR8s+r8AnlxBUqkBroB7s7QxQOexr0yzgtoCXLyA1yW8gmWzmIbah4T+LG320AQ2W7z0LNHPtC7emSBZRKs4FanRrmIVBvCIvX/BX+JLfXFGyTc6Q1sawkLbhuGvWPqIIG835hE5DgqCMKVVfFaCL2sd1dRxlLoM04CMMhDCWRKqtP+uQEwDrgi1PcFVqAhPCkQ4MNdfn6w7K7vk5dJJEPKiI5a9qDHxGQ0Ibq7MwirzzX36FPIw5OYTDtwQdB8DWb4Q2RBeQIkex6tLSAAtru/6zQpixm2qHftbCyEDUqK0oww4buA=
    app: budget-my-funds-prod-api
